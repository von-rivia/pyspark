drop table if exists sandbox.ganafinanciero.revision_devengos_24;
create table if not exists sandbox.ganafinanciero.revision_devengos_24 AS
Select *
from (SELECT a.codig,a.fecha,sum(a.debit) as debito,  sum(a.credi) as credito,b.cod_linea,b.rol_cuenta,a.fepro
--ROW_NUMBER() OVER (PARTITION BY codig,fecha 
--ORDER BY a.data_date_part DESC) AS RN
FROM bu_syp_in_hist.mov_contab_fusion as a
INNER JOIN bu_syp_in.plancta_contab_fusion as b ON a.codig = b.cuenta
where(((a.fecha) Between 20240101 And 20250128) and a.data_date_part not in ('2025-01-13') AND not in bu_syp_in.plancta_contab_fusion.fecha(20241230) and ((b.cod_linea) in (8100,8101,8800,8200,8950,10100,10300,10500,10850,10200,10101,13500,13650,13860,13700,8150,8250,10150,13400,13300,8900,10800,13800,13850,8700,10600,13600,8625,8600,8500,8520,13550,8850,10400,10700,15100,1500,2500,3500,1100,1150,2100,13100,8400,12300,13930,8300,13940,13900,13950,13200,12600,12400,12700,12100,12200,8301,12101,12201,12401,12601,12701,13901,13201,13941,13951,1900,15300,17100,1200,3200,1600,2600,3600,3910,13620,13680,8510,1300,1950,2950,3950,10900,1400,1800,2800,3800,1700,2700,3700,6650,8650,12500,1970,1971,1972,1973,1974,1975,9150,11200,11250,2900,3900,4900,5300,6500,15200,9100,11100,14200,14300,9200,11600,14400,14450,9600,11300,11310,14650,14660,14700,14710,11350,9300,9400,9500,11800,14600,11700,14500,11400,11500,16100,14100,4050,9050,6150,13902,4100,4200,16200,16300,18100,11900,14550,14580,6450,4080,4500,6100,14470,4950,5400,6600,4800,6400,4300,4400,5100,4600,5200,6200,9900,11950,4700,6300,60100,60200,60300,11000))
AND ((b.rol_cuenta) in(71,51,53,73,1,12,10,50,52)))
GROUP BY
  a.codig,
  a.fecha,
  b.cod_linea,
  b.rol_cuenta,
  a.fepro ) x
--  a.data_date_part) x
--WHERE
--x.RN <= 1;